2025-09-13 10:37:20,358 - root - INFO - Overpass tiling: bbox=(41.823640401993686, -2.030439754871649, 43.38624212792713, 3.284694913285449) tile_size=1.0 approx_tiles=12
2025-09-13 10:37:20,359 - root - INFO - Overpass tile 1/12: (41.823640401993686, -2.030439754871649, 42.823640401993686, -1.030439754871649)
2025-09-13 10:37:20,359 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:21,620 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=17
2025-09-13 10:37:21,621 - root - INFO - Overpass tile 1: received 17 elements
2025-09-13 10:37:22,125 - root - INFO - Overpass tile 2/12: (41.823640401993686, -1.030439754871649, 42.823640401993686, -0.030439754871649072)
2025-09-13 10:37:22,125 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:23,260 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=4
2025-09-13 10:37:23,261 - root - INFO - Overpass tile 2: received 4 elements
2025-09-13 10:37:23,766 - root - INFO - Overpass tile 3/12: (41.823640401993686, -0.030439754871649072, 42.823640401993686, 0.9695602451283509)
2025-09-13 10:37:23,766 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:24,705 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=9
2025-09-13 10:37:24,706 - root - INFO - Overpass tile 3: received 9 elements
2025-09-13 10:37:25,208 - root - INFO - Overpass tile 4/12: (41.823640401993686, 0.9695602451283509, 42.823640401993686, 1.969560245128351)
2025-09-13 10:37:25,209 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:26,239 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=14
2025-09-13 10:37:26,239 - root - INFO - Overpass tile 4: received 14 elements
2025-09-13 10:37:26,742 - root - INFO - Overpass tile 5/12: (41.823640401993686, 1.969560245128351, 42.823640401993686, 2.969560245128351)
2025-09-13 10:37:26,742 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:28,063 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=16
2025-09-13 10:37:28,064 - root - INFO - Overpass tile 5: received 16 elements
2025-09-13 10:37:28,569 - root - INFO - Overpass tile 6/12: (41.823640401993686, 2.969560245128351, 42.823640401993686, 3.284694913285449)
2025-09-13 10:37:28,569 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:29,323 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=10
2025-09-13 10:37:29,323 - root - INFO - Overpass tile 6: received 10 elements
2025-09-13 10:37:29,824 - root - INFO - Overpass tile 7/12: (42.823640401993686, -2.030439754871649, 43.38624212792713, -1.030439754871649)
2025-09-13 10:37:29,825 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:30,979 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=16
2025-09-13 10:37:30,979 - root - INFO - Overpass tile 7: received 16 elements
2025-09-13 10:37:31,484 - root - INFO - Overpass tile 8/12: (42.823640401993686, -1.030439754871649, 43.38624212792713, -0.030439754871649072)
2025-09-13 10:37:31,485 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:32,844 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=5
2025-09-13 10:37:32,845 - root - INFO - Overpass tile 8: received 5 elements
2025-09-13 10:37:33,350 - root - INFO - Overpass tile 9/12: (42.823640401993686, -0.030439754871649072, 43.38624212792713, 0.9695602451283509)
2025-09-13 10:37:33,350 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:34,644 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=2
2025-09-13 10:37:34,644 - root - INFO - Overpass tile 9: received 2 elements
2025-09-13 10:37:35,149 - root - INFO - Overpass tile 10/12: (42.823640401993686, 0.9695602451283509, 43.38624212792713, 1.969560245128351)
2025-09-13 10:37:35,149 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:36,537 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=5
2025-09-13 10:37:36,537 - root - INFO - Overpass tile 10: received 5 elements
2025-09-13 10:37:37,041 - root - INFO - Overpass tile 11/12: (42.823640401993686, 1.969560245128351, 43.38624212792713, 2.969560245128351)
2025-09-13 10:37:37,041 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:38,820 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=3
2025-09-13 10:37:38,820 - root - INFO - Overpass tile 11: received 3 elements
2025-09-13 10:37:39,324 - root - INFO - Overpass tile 12/12: (42.823640401993686, 2.969560245128351, 43.38624212792713, 3.284694913285449)
2025-09-13 10:37:39,324 - root - INFO - Overpass: POST https://overpass-api.de/api/interpreter
2025-09-13 10:37:39,999 - root - INFO - Overpass: success on https://overpass-api.de/api/interpreter (attempt 1) elements=2
2025-09-13 10:37:39,999 - root - INFO - Overpass tile 12: received 2 elements
2025-09-13 10:37:40,504 - root - INFO - Overpass complete: total unique places 103
2025-09-13 10:37:40,694 - city_analysis.distance - INFO - Calculating distances using perimeter with bounds: (-2.030439754871649, 41.823640401993686, 3.284694913285449, 43.38624212792713)
2025-09-13 10:37:40,694 - city_analysis.distance - INFO - Distance calculation complete: 26 successful, 0 fallbacks, 0 errors
Enriching places with elevation data...
2025-09-13 10:37:40,695 - city_analysis.elevation - INFO - Fetching elevation data for 26 places...
2025-09-13 10:37:51,048 - city_analysis.elevation - INFO - Elevation enrichment complete. Stats: {'total_requests': 26, 'cache_hits': 0, 'cache_size': 26, 'opentopo': 12, 'google': 0, 'open_elevation': 14}
Checking hospital presence via OSM (default)
Checking hospitals (OSM):   0%|          | 0/26 [00:00<?, ?city/s]Checking hospitals (OSM):   8%|▊         | 2/26 [00:01<00:14,  1.68city/s]Checking hospitals (OSM):  12%|█▏        | 3/26 [00:02<00:16,  1.37city/s]Checking hospitals (OSM):  15%|█▌        | 4/26 [00:03<00:18,  1.19city/s]Checking hospitals (OSM):  19%|█▉        | 5/26 [00:04<00:18,  1.11city/s]Checking hospitals (OSM):  23%|██▎       | 6/26 [00:05<00:18,  1.06city/s]Checking hospitals (OSM):  27%|██▋       | 7/26 [00:06<00:17,  1.07city/s]Checking hospitals (OSM):  31%|███       | 8/26 [00:07<00:17,  1.04city/s]Checking hospitals (OSM):  35%|███▍      | 9/26 [00:08<00:16,  1.04city/s]Checking hospitals (OSM):  38%|███▊      | 10/26 [00:09<00:15,  1.02city/s]Checking hospitals (OSM):  42%|████▏     | 11/26 [00:10<00:14,  1.02city/s]Checking hospitals (OSM):  46%|████▌     | 12/26 [00:11<00:13,  1.01city/s]Checking hospitals (OSM):  50%|█████     | 13/26 [00:12<00:12,  1.01city/s]Checking hospitals (OSM):  54%|█████▍    | 14/26 [00:13<00:12,  1.01s/city]Checking hospitals (OSM):  58%|█████▊    | 15/26 [00:14<00:10,  1.01city/s]Checking hospitals (OSM):  62%|██████▏   | 16/26 [00:15<00:09,  1.01city/s]Checking hospitals (OSM):  65%|██████▌   | 17/26 [00:16<00:08,  1.00city/s]Checking hospitals (OSM):  69%|██████▉   | 18/26 [00:17<00:08,  1.02s/city]Checking hospitals (OSM):  73%|███████▎  | 19/26 [00:18<00:07,  1.02s/city]Checking hospitals (OSM):  77%|███████▋  | 20/26 [00:19<00:05,  1.01city/s]Checking hospitals (OSM):  81%|████████  | 21/26 [00:20<00:04,  1.01city/s]Checking hospitals (OSM):  85%|████████▍ | 22/26 [00:21<00:04,  1.01s/city]Checking hospitals (OSM):  88%|████████▊ | 23/26 [00:22<00:03,  1.01s/city]Checking hospitals (OSM):  92%|█████████▏| 24/26 [00:23<00:01,  1.01city/s]Checking hospitals (OSM):  96%|█████████▌| 25/26 [00:24<00:00,  1.01city/s]Checking hospitals (OSM): 100%|██████████| 26/26 [00:25<00:00,  1.01s/city]Checking hospitals (OSM): 100%|██████████| 26/26 [00:25<00:00,  1.03city/s]
Finding nearest international airports and driving metrics...
Using offline dataset mode (default; no OpenAI)
Nearest airports (offline):   0%|          | 0/26 [00:00<?, ?city/s]Nearest airports (offline):   4%|▍         | 1/26 [00:02<01:12,  2.89s/city]Nearest airports (offline):   8%|▊         | 2/26 [00:05<01:10,  2.95s/city]Nearest airports (offline):  12%|█▏        | 3/26 [00:08<01:08,  2.96s/city]Nearest airports (offline):  15%|█▌        | 4/26 [00:11<01:05,  2.99s/city]Nearest airports (offline):  19%|█▉        | 5/26 [00:14<01:02,  2.99s/city]Nearest airports (offline):  23%|██▎       | 6/26 [00:17<01:00,  3.01s/city]Nearest airports (offline):  27%|██▋       | 7/26 [00:20<00:56,  2.99s/city]Nearest airports (offline):  31%|███       | 8/26 [00:23<00:53,  2.98s/city]Nearest airports (offline):  35%|███▍      | 9/26 [00:26<00:51,  3.02s/city]Nearest airports (offline):  38%|███▊      | 10/26 [00:29<00:48,  3.01s/city]Nearest airports (offline):  42%|████▏     | 11/26 [00:32<00:44,  3.00s/city]Nearest airports (offline):  46%|████▌     | 12/26 [00:35<00:42,  3.02s/city]Nearest airports (offline):  50%|█████     | 13/26 [00:38<00:39,  3.00s/city]Nearest airports (offline):  54%|█████▍    | 14/26 [00:41<00:35,  2.99s/city]Nearest airports (offline):  58%|█████▊    | 15/26 [00:44<00:33,  3.02s/city]Nearest airports (offline):  62%|██████▏   | 16/26 [00:47<00:29,  2.99s/city]Nearest airports (offline):  65%|██████▌   | 17/26 [00:50<00:26,  2.98s/city]Nearest airports (offline):  69%|██████▉   | 18/26 [00:53<00:23,  2.99s/city]Nearest airports (offline):  73%|███████▎  | 19/26 [00:56<00:21,  3.02s/city]Nearest airports (offline):  77%|███████▋  | 20/26 [00:59<00:18,  3.00s/city]Nearest airports (offline):  81%|████████  | 21/26 [01:02<00:14,  2.99s/city]Nearest airports (offline):  85%|████████▍ | 22/26 [01:05<00:11,  2.99s/city]Nearest airports (offline):  88%|████████▊ | 23/26 [01:08<00:08,  2.99s/city]Nearest airports (offline):  92%|█████████▏| 24/26 [01:11<00:05,  2.99s/city]Nearest airports (offline):  96%|█████████▌| 25/26 [01:14<00:03,  3.00s/city]Nearest airports (offline): 100%|██████████| 26/26 [01:17<00:00,  3.01s/city]Nearest airports (offline): 100%|██████████| 26/26 [01:17<00:00,  3.00s/city]
Wrote interactive map to /Users/grantduncan/Documents/coding/city_analysis_v2/outputs/pyrenees/pyrenees_cities_map.html
Wrote country-colored map to /Users/grantduncan/Documents/coding/city_analysis_v2/outputs/pyrenees/pyrenees_cities_country_map.html
Summary:
  total_places: 26
  with_population: 26
  missing_population: 0

Top 20 by population:
  Olot (ES) — pop 33,524 @ (42.1810,2.4901) [geonames], elev 437.0m [opentopo:0.9], 0.0 km to Pyrenees
  Andorra la Vella (AD) — pop 20,430 @ (42.5078,1.5211) [geonames], elev 1040.0m [opentopo:0.9], 0.0 km to Pyrenees
  Oria (ES) — pop 17,842 @ (43.2554,-2.0187) [geonames], elev 35.0m [opentopo:0.9], 0.0 km to Pyrenees
  Berga (ES) — pop 17,160 @ (42.1043,1.8463) [geonames], elev 742.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Les Escaldes (AD) — pop 15,853 @ (42.5073,1.5341) [geonames], elev 1028.0m [opentopo:0.9], 0.0 km to Pyrenees
  Lourdes (ES) — pop 15,786 @ (43.0946,-0.0461) [geonames], elev 411.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Jaca (ES) — pop 13,396 @ (42.5690,-0.5499) [geonames], elev 823.0m [opentopo:0.9], 0.0 km to Pyrenees
  Andoain (ES) — pop 13,111 @ (43.2183,-2.0199) [osm], elev 69.0m, 0.0 km to Pyrenees
  La Seu d'Urgell (ES) — pop 12,041 @ (42.3588,1.4614) [geonames], elev 700.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Encamp (AD) — pop 11,223 @ (42.5347,1.5801) [geonames], elev 1255.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Ripoll (ES) — pop 11,057 @ (42.2006,2.1903) [geonames], elev 689.0m [opentopo:0.9], 0.0 km to Pyrenees
  Ansoáin / Antsoain (ES) — pop 10,573 @ (42.8338,-1.6397) [osm], elev 427.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Sabiñánigo (ES) — pop 10,378 @ (42.5192,-0.3661) [geonames], elev 810.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Foix (ES) — pop 9,860 @ (42.9654,1.6071) [geonames], elev 385.0m [opentopo:0.9], 0.0 km to Pyrenees
  Bagnères-de-Bigorre (FR) — pop 8,967 @ (43.0650,0.1488) [geonames], elev 547.0m [opentopo:0.9], 0.0 km to Pyrenees
  Puigcerdà (ES) — pop 8,845 @ (42.4316,1.9282) [geonames], elev 1213.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Sant Cristòfol de les Fonts (ES) — pop 8,791 @ (42.1696,2.4994) [geonames], elev 471.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Ceret (FR) — pop 8,171 @ (42.4853,2.7480) [geonames], elev 184.0m [opentopo:0.9], 0.0 km to Pyrenees
  Sant Julià de Lòria (AD) — pop 8,022 @ (42.4637,1.4913) [geonames], elev 908.0m [open_elevation:0.8], 0.0 km to Pyrenees
  Lavelanet (FR) — pop 7,382 @ (42.9327,1.8484) [geonames], elev 531.0m [open_elevation:0.8], 0.0 km to Pyrenees
